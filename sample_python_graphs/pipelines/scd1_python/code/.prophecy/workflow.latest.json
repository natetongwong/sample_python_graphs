{
  "metainfo" : {
    "migrationVersions" : {
      "gemBuilderVersion" : "v1"
    },
    "id" : "1",
    "uri" : "pipelines/scd1_python",
    "language" : "python",
    "fabricId" : "4678",
    "frontEndLanguage" : "sql",
    "mode" : "batch",
    "udfs" : {
      "language" : "python",
      "udfs" : [ ],
      "functionPackageName" : "nathanprophecy.io_team.test_unlinked.functions",
      "sharedFunctionPackageNames" : [ "prophecy.spark_basic.functions", "prophecy.warehouse.functions" ]
    },
    "udafs" : {
      "language" : "python",
      "code" : ""
    },
    "configuration" : {
      "common" : {
        "type" : "record",
        "fields" : [ {
          "name" : "GenerateRandomIncrement",
          "kind" : {
            "type" : "record",
            "fields" : [ {
              "name" : "output_path",
              "kind" : {
                "type" : "string",
                "value" : "dbfs:/data/tmp/customers_merge_python_1"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "merge_condition",
              "kind" : {
                "type" : "string",
                "value" : "source.customer_id = target.customer_id"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            } ]
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : true,
          "isReferenced" : false
        } ]
      },
      "oldCommon" : {
        "type" : "record",
        "fields" : [ ]
      },
      "fabrics" : { },
      "instances" : { },
      "selected" : "default",
      "nonEditable" : [ ],
      "isSubscribedPipelineWithPipelineConfigs" : false
    },
    "sparkConf" : [ ],
    "hadoopConf" : [ ],
    "codeMode" : "sparse",
    "buildSystem" : "maven",
    "externalDependencies" : [ ],
    "dependentProjectExternalDependencies" : [ {
      "projectUID" : "12654",
      "projectName" : "ProphecySparkBasicsPython",
      "externalDependencies" : [ ]
    }, {
      "projectUID" : "12655",
      "projectName" : "ProphecyWarehousePython",
      "externalDependencies" : [ ]
    } ],
    "isImported" : false,
    "interimMode" : "Full",
    "interimModeEnabled" : true,
    "visualCodeInterimMode" : "Disabled",
    "recordsLimit" : {
      "enabled" : false,
      "value" : 1000
    },
    "topLevelPackage" : "scdpython",
    "configurationVersion" : "v1"
  },
  "connections" : [ {
    "id" : "Vgix2MvX8CPAUvD__YpBn",
    "source" : "rfiq2Toc-drR8KWoi37Hm$$4pjBEEXicj4K91ciDa6BN",
    "sourcePort" : "yBQpVmDVv1QzBpXHngeuD$$pWzhlF0WWNR4RXcJTabP4",
    "target" : "ACmhiB-j61JCA3Q9gMuh4$$du7pz7z5cl_DGkSjZk8Xl",
    "targetPort" : "VWmm7fGhC8jbSA8elTiO6$$438malNFsrwzk5OR6gtJ_"
  } ],
  "processes" : {
    "rfiq2Toc-drR8KWoi37Hm$$4pjBEEXicj4K91ciDa6BN" : {
      "id" : "rfiq2Toc-drR8KWoi37Hm$$4pjBEEXicj4K91ciDa6BN",
      "component" : "Subgraph",
      "metadata" : {
        "label" : "GenerateRandomIncrement",
        "slug" : "GenerateRandomIncrement",
        "x" : -220,
        "y" : 80,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false,
        "comment" : "This pipeline graph generates random increments to customer data by selecting specific fields, removing duplicates, and transforming the schema. It then distributes the data into three separate dataframes, applies additional schema transformations, and performs a set operation to combine the dataframes. Finally, it removes a random ID column and drops any remaining duplicates to produce a clean and enriched customer dataset."
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "yBQpVmDVv1QzBpXHngeuD$$pWzhlF0WWNR4RXcJTabP4",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "packageName" : "data",
        "externalId" : "subgraphs/GenerateRandomIncrement",
        "name" : "GenerateRandomIncrement"
      },
      "connections" : [ {
        "id" : "iW9_mysydzOrNd1jtPGCT",
        "source" : "pMN06Mx4cGNCTF5xIo19z$$h4ZMt0R31vU04M83xUnag",
        "sourcePort" : "nRKFrJk3FjH1GHN-QgsN9$$nrKx4znLxeD-SP41HBYIC",
        "target" : "oYnx2RIhGhCqQyq7sNfpI$$4FEQ1aIaHFCUCi0uOsn2z",
        "targetPort" : "mM7ir_D0scKCAg_eQl4Ru$$DJ1UeHrUnGYtXUuCGmbPF"
      }, {
        "id" : "nWCi4Zch5CeAkhRd6eeLl",
        "source" : "oYnx2RIhGhCqQyq7sNfpI$$4FEQ1aIaHFCUCi0uOsn2z",
        "sourcePort" : "WjscrqYe7iGTGw6ehkQg6$$w6_oEi-ULs-4bYj2S_dzb",
        "target" : "ijP-AI7o0asM_ss70X5IP$$EI8o_xxiGQ9AL_vgyQZHT",
        "targetPort" : "QeD23uC8wixYTZ_to5c89$$diWVcVbwuqoaHEe6Ojiac"
      }, {
        "id" : "Q1nsNfmTFB-oZEeauPrUl",
        "source" : "ijP-AI7o0asM_ss70X5IP$$EI8o_xxiGQ9AL_vgyQZHT",
        "sourcePort" : "5aAZFmF8E-INCsFuFfWAN$$RKGFfifgm7ho_meTzNdKV",
        "target" : "pHiX4xWnPMs1Gkvi0bcOZ$$vY6kILmhf4xyErcFe580U",
        "targetPort" : "5wlEJ9rrYtAyxVH01SOG3$$dAO1UqB48NR8C-pz7oRGc"
      }, {
        "id" : "YVgMnR2xNHmv0n8zOrNFN",
        "source" : "pHiX4xWnPMs1Gkvi0bcOZ$$vY6kILmhf4xyErcFe580U",
        "sourcePort" : "F8xnFhuYYiJWcTag98pr2$$poAPRAotbhzl8rourOznM",
        "target" : "YsLv9M_vzkBBbsxYJUCUV$$0i68A3bN9Gtvv0r2dE5V5",
        "targetPort" : "DltODBRTEWjBdDbNIpVxy$$lYuG14WRBJHfno94x5BAy"
      }, {
        "id" : "Qc4Z_zsWNJKjSR8u2UqDs",
        "source" : "YsLv9M_vzkBBbsxYJUCUV$$0i68A3bN9Gtvv0r2dE5V5",
        "sourcePort" : "BzetactkhDOfMOg2gSh6w$$K9F4-aOVjWRRZ12Wnsvul",
        "target" : "Dj6oja_WmBTXMN3AJOvSx$$0mA_YiEBf-SCqQM6rEWsW",
        "targetPort" : "CqUNgShTLlIP_9rGWdQw5$$wHHgNENFY-EqMijXshxKd"
      }, {
        "id" : "pc5jjLXZEF5ozs_-LoHct",
        "source" : "YsLv9M_vzkBBbsxYJUCUV$$0i68A3bN9Gtvv0r2dE5V5",
        "sourcePort" : "3tTwgv9x04B4cnmRTuIvR$$vNhwHvIU0yNpekGKONEGb",
        "target" : "BO3hrv5tZ8LxoTOjZ6Ajv$$Rx8F8to63snLcZo1r-TcD",
        "targetPort" : "gJ4OqobFeoe-4rQkQYgsz$$1kTwf3XaDHlc-CW1ED_YR"
      }, {
        "id" : "5iCNX4Ef6AwebEUVoC5ez",
        "source" : "YsLv9M_vzkBBbsxYJUCUV$$0i68A3bN9Gtvv0r2dE5V5",
        "sourcePort" : "1Uz_9EH85JsTgAYbj-mkd$$_UWeRxDU5NA9MbroW6QWn",
        "target" : "_wPo8nbcxQjMT-oUP80vb$$3sothnjdSJJGA2k2GZ9ML",
        "targetPort" : "QfE6jzKSeJ2e8ieA7Cp7D$$V_MAmZrvy_yquiTr975i1"
      }, {
        "id" : "erCckECC4O_97kDx9Uc3d",
        "source" : "Dj6oja_WmBTXMN3AJOvSx$$0mA_YiEBf-SCqQM6rEWsW",
        "sourcePort" : "wTsreSYOqpBYFlyOlD0Co$$0P9CdDwiDRkPtv6E8hhGN",
        "target" : "_wPo8nbcxQjMT-oUP80vb$$3sothnjdSJJGA2k2GZ9ML",
        "targetPort" : "t2NliMEf8MbMxm93AW1-f$$l6wQGV8z3i8zE6P9nrUIR"
      }, {
        "id" : "I-IRCVbGv00pDVX3UNG8g",
        "source" : "BO3hrv5tZ8LxoTOjZ6Ajv$$Rx8F8to63snLcZo1r-TcD",
        "sourcePort" : "Id2XhH-cygg4tUCsh-uJI$$FhC3FDuyBN8jkjq-_9pui",
        "target" : "_wPo8nbcxQjMT-oUP80vb$$3sothnjdSJJGA2k2GZ9ML",
        "targetPort" : "Ns16gtqhh32YXej-8Kn3q$$-zg9_PdDkq5EKBKIIA-bz"
      }, {
        "id" : "_lRUxYpebrFKn3cnWc1II",
        "source" : "_wPo8nbcxQjMT-oUP80vb$$3sothnjdSJJGA2k2GZ9ML",
        "sourcePort" : "DolCO-f59RV5mwmX4Vapr$$8rUgTzljRHUAdXQiu07A5",
        "target" : "ULnjpJmU0yQOfWY7sIxk5$$usuji8Utxuk17HoA6f29M",
        "targetPort" : "obfkU4wZhOigLfWcLbrvN$$FvPwanEvAs7zHWrfTtf3W"
      }, {
        "id" : "SifSrOCiHDCtV2VLzI_48",
        "source" : "ULnjpJmU0yQOfWY7sIxk5$$usuji8Utxuk17HoA6f29M",
        "sourcePort" : "pLt1sEek6bBZM0u-uqkYC$$CNQ5G_gaFIdXo5iNXIbHQ",
        "target" : "h_oHj4RIiO0UOF_pBfL0t$$vKqa6XA72mF4tuLxoXoz6",
        "targetPort" : "oK7dNs66H-ZMxyQRyxvZp$$BXEkduHvvQObrNP-mh1Cu"
      }, {
        "id" : "NZcHOnvykv9FtHIK_ljKG",
        "source" : "h_oHj4RIiO0UOF_pBfL0t$$vKqa6XA72mF4tuLxoXoz6",
        "sourcePort" : "GY___oXo-84TpUMer3Qrg$$tLjjCXwsc56waZ5TZBSwJ",
        "target" : "rfiq2Toc-drR8KWoi37Hm$$4pjBEEXicj4K91ciDa6BN",
        "targetPort" : "yBQpVmDVv1QzBpXHngeuD$$pWzhlF0WWNR4RXcJTabP4"
      } ],
      "processes" : {
        "ijP-AI7o0asM_ss70X5IP$$EI8o_xxiGQ9AL_vgyQZHT" : {
          "id" : "ijP-AI7o0asM_ss70X5IP$$EI8o_xxiGQ9AL_vgyQZHT",
          "component" : "Deduplicate",
          "metadata" : {
            "label" : "Deduplicate_1",
            "slug" : "Deduplicate_1",
            "x" : 560.0005275352471,
            "y" : 160,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false,
            "comment" : "Remove any duplicate customer_id. "
          },
          "ports" : {
            "inputs" : [ {
              "id" : "QeD23uC8wixYTZ_to5c89$$diWVcVbwuqoaHEe6Ojiac",
              "slug" : "in0",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "customer_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tax_id",
                  "type" : "double",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tax_code",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "customer_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "state",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "5aAZFmF8E-INCsFuFfWAN$$RKGFfifgm7ho_meTzNdKV",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "dedupColumns" : [ {
              "colName" : "customer_id"
            } ],
            "dedupType" : "any",
            "columnsSelector" : [ "QeD23uC8wixYTZ_to5c89$$diWVcVbwuqoaHEe6Ojiac##customer_id" ],
            "orders" : [ ],
            "useOrderBy" : false
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.0.4&projectSubscriptionProjectId=12654&path=gems/Deduplicate",
            "projectName" : "ProphecySparkBasicsPython"
          }
        },
        "YsLv9M_vzkBBbsxYJUCUV$$0i68A3bN9Gtvv0r2dE5V5" : {
          "id" : "YsLv9M_vzkBBbsxYJUCUV$$0i68A3bN9Gtvv0r2dE5V5",
          "component" : "RowDistributor",
          "metadata" : {
            "label" : "RowDistributor_1",
            "slug" : "RowDistributor_1",
            "x" : 960.0005268311457,
            "y" : 160,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false,
            "comment" : "The function splits the existing dataframe into three separate dataframes depending on the randomly assigned random_id number."
          },
          "ports" : {
            "inputs" : [ {
              "id" : "DltODBRTEWjBdDbNIpVxy$$lYuG14WRBJHfno94x5BAy",
              "slug" : "in0",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "customer_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tax_id",
                  "type" : "double",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tax_code",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "customer_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "state",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "random_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "1Uz_9EH85JsTgAYbj-mkd$$_UWeRxDU5NA9MbroW6QWn",
              "slug" : "out0"
            }, {
              "id" : "BzetactkhDOfMOg2gSh6w$$K9F4-aOVjWRRZ12Wnsvul",
              "slug" : "out1"
            }, {
              "id" : "3tTwgv9x04B4cnmRTuIvR$$vNhwHvIU0yNpekGKONEGb",
              "slug" : "out2"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "outports" : [ {
              "path" : "out0",
              "id" : "1Uz_9EH85JsTgAYbj-mkd$$_UWeRxDU5NA9MbroW6QWn",
              "model" : {
                "format" : "sql",
                "expression" : "random_id = 0"
              }
            }, {
              "path" : "out1",
              "id" : "BzetactkhDOfMOg2gSh6w$$K9F4-aOVjWRRZ12Wnsvul",
              "model" : {
                "format" : "sql",
                "expression" : "random_id = 1"
              }
            }, {
              "path" : "out2",
              "id" : "3tTwgv9x04B4cnmRTuIvR$$vNhwHvIU0yNpekGKONEGb",
              "model" : {
                "format" : "sql",
                "expression" : "random_id = 2"
              }
            } ],
            "distributeUnmatchedRows" : null
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.0.4&projectSubscriptionProjectId=12654&path=gems/RowDistributor",
            "projectName" : "ProphecySparkBasicsPython"
          }
        },
        "h_oHj4RIiO0UOF_pBfL0t$$vKqa6XA72mF4tuLxoXoz6" : {
          "id" : "h_oHj4RIiO0UOF_pBfL0t$$vKqa6XA72mF4tuLxoXoz6",
          "component" : "Deduplicate",
          "metadata" : {
            "label" : "Deduplicate_2",
            "slug" : "Deduplicate_2",
            "x" : 1760.00024880422,
            "y" : 160,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false,
            "comment" : "Run another deduplicate function on customer_id. "
          },
          "ports" : {
            "inputs" : [ {
              "id" : "oK7dNs66H-ZMxyQRyxvZp$$BXEkduHvvQObrNP-mh1Cu",
              "slug" : "in0",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "customer_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tax_id",
                  "type" : "double",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tax_code",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "customer_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "state",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "GY___oXo-84TpUMer3Qrg$$tLjjCXwsc56waZ5TZBSwJ",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "dedupColumns" : [ {
              "colName" : "customer_id"
            } ],
            "dedupType" : "any",
            "columnsSelector" : [ "oK7dNs66H-ZMxyQRyxvZp$$BXEkduHvvQObrNP-mh1Cu##customer_id" ],
            "orders" : [ ],
            "useOrderBy" : false
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.0.4&projectSubscriptionProjectId=12654&path=gems/Deduplicate",
            "projectName" : "ProphecySparkBasicsPython"
          }
        },
        "BO3hrv5tZ8LxoTOjZ6Ajv$$Rx8F8to63snLcZo1r-TcD" : {
          "id" : "BO3hrv5tZ8LxoTOjZ6Ajv$$Rx8F8to63snLcZo1r-TcD",
          "component" : "SchemaTransform",
          "metadata" : {
            "label" : "SchemaTransform_3",
            "slug" : "SchemaTransform_3",
            "x" : 1160,
            "y" : 460,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false,
            "comment" : "For this distribution of rows, we will make modifications to existing customer_ids, simulating updates."
          },
          "ports" : {
            "inputs" : [ {
              "id" : "gJ4OqobFeoe-4rQkQYgsz$$1kTwf3XaDHlc-CW1ED_YR",
              "slug" : "in0",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "customer_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tax_id",
                  "type" : "double",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tax_code",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "customer_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "state",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "random_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "Id2XhH-cygg4tUCsh-uJI$$FhC3FDuyBN8jkjq-_9pui",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "importLanguage" : "sql",
            "importString" : "",
            "transformations" : [ {
              "MissingColumn" : {
                "sourceColumn" : "",
                "defaultValue" : {
                  "expression" : "",
                  "format" : "python"
                }
              },
              "DropColumn" : {
                "sourceColumn" : ""
              },
              "kind" : "AddReplaceColumn",
              "RenameColumn" : {
                "sourceColumn" : "",
                "targetColumn" : ""
              },
              "AddReplaceColumn" : {
                "sourceColumn" : "customer_name",
                "expression" : {
                  "format" : "sql",
                  "expression" : "if(rand() > 0.5, upper(customer_name), lower(customer_name))"
                }
              }
            } ],
            "activeTab" : "transformations",
            "columnsSelector" : [ "gJ4OqobFeoe-4rQkQYgsz$$1kTwf3XaDHlc-CW1ED_YR##customer_name" ]
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.0.4&projectSubscriptionProjectId=12654&path=gems/SchemaTransform",
            "projectName" : "ProphecySparkBasicsPython"
          }
        },
        "pMN06Mx4cGNCTF5xIo19z$$h4ZMt0R31vU04M83xUnag" : {
          "id" : "pMN06Mx4cGNCTF5xIo19z$$h4ZMt0R31vU04M83xUnag",
          "component" : "Source",
          "metadata" : {
            "label" : "customers_raw",
            "slug" : "customers_raw",
            "x" : 160.00096079878793,
            "y" : 160,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false,
            "comment" : "Reads Customers CSV file from retail dataset."
          },
          "ports" : {
            "inputs" : [ ],
            "outputs" : [ {
              "id" : "nRKFrJk3FjH1GHN-QgsN9$$nrKx4znLxeD-SP41HBYIC",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "datasetId" : "datasets/customers_raw"
          }
        },
        "ULnjpJmU0yQOfWY7sIxk5$$usuji8Utxuk17HoA6f29M" : {
          "id" : "ULnjpJmU0yQOfWY7sIxk5$$usuji8Utxuk17HoA6f29M",
          "component" : "SchemaTransform",
          "metadata" : {
            "label" : "DropRandomId",
            "slug" : "DropRandomId",
            "x" : 1560.0007206304692,
            "y" : 160,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false,
            "comment" : "Drop the random_id column that was generated in the earlier SchemaTransform gem. "
          },
          "ports" : {
            "inputs" : [ {
              "id" : "obfkU4wZhOigLfWcLbrvN$$FvPwanEvAs7zHWrfTtf3W",
              "slug" : "in0",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "customer_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tax_id",
                  "type" : "double",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tax_code",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "customer_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "state",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "random_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "pLt1sEek6bBZM0u-uqkYC$$CNQ5G_gaFIdXo5iNXIbHQ",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "importLanguage" : "sql",
            "importString" : "",
            "transformations" : [ {
              "MissingColumn" : {
                "sourceColumn" : "",
                "defaultValue" : {
                  "expression" : "",
                  "format" : "python"
                }
              },
              "DropColumn" : {
                "sourceColumn" : "random_id"
              },
              "kind" : "DropColumn",
              "RenameColumn" : {
                "sourceColumn" : "",
                "targetColumn" : ""
              },
              "AddReplaceColumn" : {
                "sourceColumn" : "",
                "expression" : {
                  "expression" : "",
                  "format" : "python"
                }
              }
            } ],
            "activeTab" : "transformations",
            "columnsSelector" : [ "obfkU4wZhOigLfWcLbrvN$$FvPwanEvAs7zHWrfTtf3W##random_id" ]
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.0.4&projectSubscriptionProjectId=12654&path=gems/SchemaTransform",
            "projectName" : "ProphecySparkBasicsPython"
          }
        },
        "_wPo8nbcxQjMT-oUP80vb$$3sothnjdSJJGA2k2GZ9ML" : {
          "id" : "_wPo8nbcxQjMT-oUP80vb$$3sothnjdSJJGA2k2GZ9ML",
          "component" : "SetOperation",
          "metadata" : {
            "label" : "SetOperation_1",
            "slug" : "SetOperation_1",
            "x" : 1360.0005856762066,
            "y" : 160,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false,
            "comment" : "The function does a union of the three distributions of data across three dataframes. The 1st subset simulates unchanged data. The 2nd subset simulates updated existing records. The 3rd subset simulates brand new records. "
          },
          "ports" : {
            "inputs" : [ {
              "id" : "QfE6jzKSeJ2e8ieA7Cp7D$$V_MAmZrvy_yquiTr975i1",
              "slug" : "in0",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "customer_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tax_id",
                  "type" : "double",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tax_code",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "customer_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "state",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "random_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            }, {
              "id" : "t2NliMEf8MbMxm93AW1-f$$l6wQGV8z3i8zE6P9nrUIR",
              "slug" : "in1",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "customer_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tax_id",
                  "type" : "double",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tax_code",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "customer_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "state",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "random_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            }, {
              "id" : "Ns16gtqhh32YXej-8Kn3q$$-zg9_PdDkq5EKBKIIA-bz",
              "slug" : "in2",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "customer_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tax_id",
                  "type" : "double",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tax_code",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "customer_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "state",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "random_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "DolCO-f59RV5mwmX4Vapr$$8rUgTzljRHUAdXQiu07A5",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "operationType" : "unionAll",
            "allowMissingColumns" : false
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.0.4&projectSubscriptionProjectId=12654&path=gems/SetOperation",
            "projectName" : "ProphecySparkBasicsPython"
          }
        },
        "oYnx2RIhGhCqQyq7sNfpI$$4FEQ1aIaHFCUCi0uOsn2z" : {
          "id" : "oYnx2RIhGhCqQyq7sNfpI$$4FEQ1aIaHFCUCi0uOsn2z",
          "component" : "Reformat",
          "metadata" : {
            "label" : "SelectFields",
            "slug" : "SelectFields",
            "x" : 360.0000867557395,
            "y" : 160,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false,
            "comment" : "This gem selects a subset of relevant columns from the original CSV file. "
          },
          "ports" : {
            "inputs" : [ {
              "id" : "mM7ir_D0scKCAg_eQl4Ru$$DJ1UeHrUnGYtXUuCGmbPF",
              "slug" : "in0",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "customer_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tax_id",
                  "type" : "double",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tax_code",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "customer_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "state",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "city",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "postcode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "street",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "number",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "unit",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "region",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "district",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "lon",
                  "type" : "double",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "lat",
                  "type" : "double",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ship_to_address",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "valid_from",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "valid_to",
                  "type" : "double",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "units_purchased",
                  "type" : "double",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "loyalty_segment",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "WjscrqYe7iGTGw6ehkQg6$$w6_oEi-ULs-4bYj2S_dzb",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "importLanguage" : "${$.workflow.metainfo.frontEndLanguage}",
            "expressions" : [ {
              "target" : "customer_id",
              "expression" : {
                "format" : "sql",
                "expression" : "customer_id"
              },
              "description" : ""
            }, {
              "target" : "tax_id",
              "expression" : {
                "format" : "sql",
                "expression" : "tax_id"
              },
              "description" : ""
            }, {
              "target" : "tax_code",
              "expression" : {
                "format" : "sql",
                "expression" : "tax_code"
              },
              "description" : ""
            }, {
              "target" : "customer_name",
              "expression" : {
                "format" : "sql",
                "expression" : "customer_name"
              },
              "description" : ""
            }, {
              "target" : "state",
              "expression" : {
                "format" : "sql",
                "expression" : "state"
              },
              "description" : ""
            } ],
            "importString" : "",
            "activeTab" : "expressions",
            "columnsSelector" : [ "mM7ir_D0scKCAg_eQl4Ru$$DJ1UeHrUnGYtXUuCGmbPF##state", "mM7ir_D0scKCAg_eQl4Ru$$DJ1UeHrUnGYtXUuCGmbPF##customer_name", "mM7ir_D0scKCAg_eQl4Ru$$DJ1UeHrUnGYtXUuCGmbPF##tax_id", "mM7ir_D0scKCAg_eQl4Ru$$DJ1UeHrUnGYtXUuCGmbPF##tax_code", "mM7ir_D0scKCAg_eQl4Ru$$DJ1UeHrUnGYtXUuCGmbPF##customer_id" ]
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.0.4&projectSubscriptionProjectId=12654&path=gems/Reformat",
            "projectName" : "ProphecySparkBasicsPython"
          }
        },
        "Dj6oja_WmBTXMN3AJOvSx$$0mA_YiEBf-SCqQM6rEWsW" : {
          "id" : "Dj6oja_WmBTXMN3AJOvSx$$0mA_YiEBf-SCqQM6rEWsW",
          "component" : "SchemaTransform",
          "metadata" : {
            "label" : "SchemaTransform_2",
            "slug" : "SchemaTransform_2",
            "x" : 1160,
            "y" : 260,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false,
            "comment" : "For this distribution of rows, we will change the customer_id to a totally new id, simulating new incoming rows. "
          },
          "ports" : {
            "inputs" : [ {
              "id" : "CqUNgShTLlIP_9rGWdQw5$$wHHgNENFY-EqMijXshxKd",
              "slug" : "in0",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "customer_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tax_id",
                  "type" : "double",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tax_code",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "customer_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "state",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "random_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "wTsreSYOqpBYFlyOlD0Co$$0P9CdDwiDRkPtv6E8hhGN",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "importLanguage" : "sql",
            "importString" : "",
            "transformations" : [ {
              "MissingColumn" : {
                "sourceColumn" : "",
                "defaultValue" : {
                  "expression" : "",
                  "format" : "python"
                }
              },
              "DropColumn" : {
                "sourceColumn" : ""
              },
              "kind" : "AddReplaceColumn",
              "RenameColumn" : {
                "sourceColumn" : "",
                "targetColumn" : ""
              },
              "AddReplaceColumn" : {
                "sourceColumn" : "customer_id",
                "expression" : {
                  "format" : "sql",
                  "expression" : "customer_id + cast(floor(rand() * 10000) as int)"
                }
              }
            } ],
            "activeTab" : "transformations",
            "columnsSelector" : [ "CqUNgShTLlIP_9rGWdQw5$$wHHgNENFY-EqMijXshxKd##customer_id" ]
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.0.4&projectSubscriptionProjectId=12654&path=gems/SchemaTransform",
            "projectName" : "ProphecySparkBasicsPython"
          }
        },
        "pHiX4xWnPMs1Gkvi0bcOZ$$vY6kILmhf4xyErcFe580U" : {
          "id" : "pHiX4xWnPMs1Gkvi0bcOZ$$vY6kILmhf4xyErcFe580U",
          "component" : "SchemaTransform",
          "metadata" : {
            "label" : "SchemaTransform_1",
            "slug" : "SchemaTransform_1",
            "x" : 760.0009651870012,
            "y" : 160,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false,
            "comment" : "We will simulate a MERGE condition by modifying the existing rows to conditions that require a update or insert. \n\nRandomly assigns a number 0, 1, 2 and assigns it to each row with roughly distributes it equally. We will then:\n-Leave 1/3 of the data untouched\n-Change the customer_id for 1/3 of the data (so it's essentially new rows)\n-Modify the data for 1/3 of the rows while keeping customer_id static. "
          },
          "ports" : {
            "inputs" : [ {
              "id" : "5wlEJ9rrYtAyxVH01SOG3$$dAO1UqB48NR8C-pz7oRGc",
              "slug" : "in0",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "customer_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tax_id",
                  "type" : "double",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tax_code",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "customer_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "state",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "F8xnFhuYYiJWcTag98pr2$$poAPRAotbhzl8rourOznM",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "importLanguage" : "sql",
            "importString" : "",
            "transformations" : [ {
              "MissingColumn" : {
                "sourceColumn" : "",
                "defaultValue" : {
                  "expression" : "",
                  "format" : "python"
                }
              },
              "DropColumn" : {
                "sourceColumn" : ""
              },
              "kind" : "AddReplaceColumn",
              "RenameColumn" : {
                "sourceColumn" : "",
                "targetColumn" : ""
              },
              "AddReplaceColumn" : {
                "sourceColumn" : "random_id",
                "expression" : {
                  "format" : "sql",
                  "expression" : "floor(3*rand())"
                }
              }
            } ],
            "activeTab" : "transformations",
            "columnsSelector" : [ ]
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.0.4&projectSubscriptionProjectId=12654&path=gems/SchemaTransform",
            "projectName" : "ProphecySparkBasicsPython"
          }
        }
      },
      "externalDependencies" : [ ]
    },
    "ACmhiB-j61JCA3Q9gMuh4$$du7pz7z5cl_DGkSjZk8Xl" : {
      "id" : "ACmhiB-j61JCA3Q9gMuh4$$du7pz7z5cl_DGkSjZk8Xl",
      "component" : "Target",
      "metadata" : {
        "label" : "customers_scd1_write",
        "slug" : "customers_scd1_write",
        "x" : -20,
        "y" : 80,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false,
        "comment" : "This gem implements a Slowly Changing Dimension Type 1 (SCD1) merge operation on customer data. It checks if the target table exists and merges the source data with the target data based on the customer_id identifier. If a match is found, it updates all columns in the target table with the corresponding values from the source table. If no match is found, it inserts all columns from the source table into the target table. If the target table does not exist, it creates it and writes the source data to it in Delta format."
      },
      "ports" : {
        "inputs" : [ {
          "id" : "VWmm7fGhC8jbSA8elTiO6$$438malNFsrwzk5OR6gtJ_",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "customer_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tax_id",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tax_code",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "customer_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "state",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/customers_scd1"
      }
    },
    "em0T9keT26dk48_ZlWcKU$$HZCAtePwot9twQNiPgo39" : {
      "id" : "em0T9keT26dk48_ZlWcKU$$HZCAtePwot9twQNiPgo39",
      "component" : "Source",
      "metadata" : {
        "label" : "customers_scd1_read",
        "slug" : "customers_scd1_read",
        "x" : -220,
        "y" : 260,
        "phase" : 1,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "xoG7A8-Ko-Xwppnh3No9j$$saKSItulVD6wlA4alQbVl",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/customers_scd1"
      }
    }
  },
  "ports" : {
    "inputs" : [ ],
    "outputs" : [ ],
    "selectedInputFields" : [ ],
    "isCustomOutputSchema" : false,
    "autoUpdateOnRun" : false
  }
}