{
  "id" : "rfiq2Toc-drR8KWoi37Hm",
  "component" : "Subgraph",
  "metadata" : {
    "label" : "",
    "slug" : "",
    "x" : 0,
    "y" : 0,
    "phase" : 0,
    "cache" : false,
    "detailedStats" : false,
    "isImported" : false,
    "configuration" : {
      "common" : {
        "type" : "record",
        "fields" : [ {
          "name" : "output_path",
          "kind" : {
            "type" : "string",
            "value" : "dbfs:/data/tmp/customers_merge_python_1"
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "merge_condition",
          "kind" : {
            "type" : "string",
            "value" : "source.customer_id = target.customer_id"
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        } ]
      }
    }
  },
  "ports" : {
    "inputs" : [ ],
    "outputs" : [ {
      "id" : "yBQpVmDVv1QzBpXHngeuD",
      "slug" : "out0",
      "isStreaming" : false
    } ],
    "selectedInputFields" : [ ],
    "isCustomOutputSchema" : false,
    "autoUpdateOnRun" : false
  },
  "properties" : {
    "packageName" : "data"
  },
  "connections" : [ {
    "id" : "iW9_mysydzOrNd1jtPGCT",
    "source" : "pMN06Mx4cGNCTF5xIo19z",
    "sourcePort" : "nRKFrJk3FjH1GHN-QgsN9",
    "target" : "oYnx2RIhGhCqQyq7sNfpI",
    "targetPort" : "mM7ir_D0scKCAg_eQl4Ru"
  }, {
    "id" : "nWCi4Zch5CeAkhRd6eeLl",
    "source" : "oYnx2RIhGhCqQyq7sNfpI",
    "sourcePort" : "WjscrqYe7iGTGw6ehkQg6",
    "target" : "ijP-AI7o0asM_ss70X5IP",
    "targetPort" : "QeD23uC8wixYTZ_to5c89"
  }, {
    "id" : "Q1nsNfmTFB-oZEeauPrUl",
    "source" : "ijP-AI7o0asM_ss70X5IP",
    "sourcePort" : "5aAZFmF8E-INCsFuFfWAN",
    "target" : "pHiX4xWnPMs1Gkvi0bcOZ",
    "targetPort" : "5wlEJ9rrYtAyxVH01SOG3"
  }, {
    "id" : "YVgMnR2xNHmv0n8zOrNFN",
    "source" : "pHiX4xWnPMs1Gkvi0bcOZ",
    "sourcePort" : "F8xnFhuYYiJWcTag98pr2",
    "target" : "YsLv9M_vzkBBbsxYJUCUV",
    "targetPort" : "DltODBRTEWjBdDbNIpVxy"
  }, {
    "id" : "Qc4Z_zsWNJKjSR8u2UqDs",
    "source" : "YsLv9M_vzkBBbsxYJUCUV",
    "sourcePort" : "BzetactkhDOfMOg2gSh6w",
    "target" : "Dj6oja_WmBTXMN3AJOvSx",
    "targetPort" : "CqUNgShTLlIP_9rGWdQw5"
  }, {
    "id" : "pc5jjLXZEF5ozs_-LoHct",
    "source" : "YsLv9M_vzkBBbsxYJUCUV",
    "sourcePort" : "3tTwgv9x04B4cnmRTuIvR",
    "target" : "BO3hrv5tZ8LxoTOjZ6Ajv",
    "targetPort" : "gJ4OqobFeoe-4rQkQYgsz"
  }, {
    "id" : "5iCNX4Ef6AwebEUVoC5ez",
    "source" : "YsLv9M_vzkBBbsxYJUCUV",
    "sourcePort" : "1Uz_9EH85JsTgAYbj-mkd",
    "target" : "_wPo8nbcxQjMT-oUP80vb",
    "targetPort" : "QfE6jzKSeJ2e8ieA7Cp7D"
  }, {
    "id" : "erCckECC4O_97kDx9Uc3d",
    "source" : "Dj6oja_WmBTXMN3AJOvSx",
    "sourcePort" : "wTsreSYOqpBYFlyOlD0Co",
    "target" : "_wPo8nbcxQjMT-oUP80vb",
    "targetPort" : "t2NliMEf8MbMxm93AW1-f"
  }, {
    "id" : "I-IRCVbGv00pDVX3UNG8g",
    "source" : "BO3hrv5tZ8LxoTOjZ6Ajv",
    "sourcePort" : "Id2XhH-cygg4tUCsh-uJI",
    "target" : "_wPo8nbcxQjMT-oUP80vb",
    "targetPort" : "Ns16gtqhh32YXej-8Kn3q"
  }, {
    "id" : "_lRUxYpebrFKn3cnWc1II",
    "source" : "_wPo8nbcxQjMT-oUP80vb",
    "sourcePort" : "DolCO-f59RV5mwmX4Vapr",
    "target" : "ULnjpJmU0yQOfWY7sIxk5",
    "targetPort" : "obfkU4wZhOigLfWcLbrvN"
  }, {
    "id" : "SifSrOCiHDCtV2VLzI_48",
    "source" : "ULnjpJmU0yQOfWY7sIxk5",
    "sourcePort" : "pLt1sEek6bBZM0u-uqkYC",
    "target" : "h_oHj4RIiO0UOF_pBfL0t",
    "targetPort" : "oK7dNs66H-ZMxyQRyxvZp"
  }, {
    "id" : "NZcHOnvykv9FtHIK_ljKG",
    "source" : "h_oHj4RIiO0UOF_pBfL0t",
    "sourcePort" : "GY___oXo-84TpUMer3Qrg",
    "target" : "rfiq2Toc-drR8KWoi37Hm",
    "targetPort" : "yBQpVmDVv1QzBpXHngeuD"
  } ],
  "processes" : {
    "h_oHj4RIiO0UOF_pBfL0t" : {
      "id" : "h_oHj4RIiO0UOF_pBfL0t",
      "component" : "Deduplicate",
      "metadata" : {
        "label" : "Deduplicate_2",
        "slug" : "Deduplicate_2",
        "x" : 1760.00024880422,
        "y" : 160,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false,
        "comment" : "Run another deduplicate function on customer_id. "
      },
      "ports" : {
        "inputs" : [ {
          "id" : "oK7dNs66H-ZMxyQRyxvZp",
          "slug" : "in0"
        } ],
        "outputs" : [ {
          "id" : "GY___oXo-84TpUMer3Qrg",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "dedupColumns" : [ {
          "colName" : "customer_id"
        } ],
        "dedupType" : "any",
        "columnsSelector" : [ "oK7dNs66H-ZMxyQRyxvZp$$BXEkduHvvQObrNP-mh1Cu##customer_id" ],
        "orders" : [ ],
        "useOrderBy" : false
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.0.4&projectSubscriptionProjectId=12654&path=gems/Deduplicate",
        "projectId" : "12654",
        "projectName" : "ProphecySparkBasicsPython",
        "version" : "0.0.4"
      }
    },
    "pHiX4xWnPMs1Gkvi0bcOZ" : {
      "id" : "pHiX4xWnPMs1Gkvi0bcOZ",
      "component" : "SchemaTransform",
      "metadata" : {
        "label" : "SchemaTransform_1",
        "slug" : "SchemaTransform_1",
        "x" : 760.0009651870012,
        "y" : 160,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false,
        "comment" : "We will simulate a MERGE condition by modifying the existing rows to conditions that require a update or insert. \n\nRandomly assigns a number 0, 1, 2 and assigns it to each row with roughly distributes it equally. We will then:\n-Leave 1/3 of the data untouched\n-Change the customer_id for 1/3 of the data (so it's essentially new rows)\n-Modify the data for 1/3 of the rows while keeping customer_id static. "
      },
      "ports" : {
        "inputs" : [ {
          "id" : "5wlEJ9rrYtAyxVH01SOG3",
          "slug" : "in0"
        } ],
        "outputs" : [ {
          "id" : "F8xnFhuYYiJWcTag98pr2",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "importLanguage" : "sql",
        "importString" : "",
        "transformations" : [ {
          "MissingColumn" : {
            "sourceColumn" : "",
            "defaultValue" : {
              "expression" : "",
              "format" : "python"
            }
          },
          "DropColumn" : {
            "sourceColumn" : ""
          },
          "kind" : "AddReplaceColumn",
          "RenameColumn" : {
            "sourceColumn" : "",
            "targetColumn" : ""
          },
          "AddReplaceColumn" : {
            "sourceColumn" : "random_id",
            "expression" : {
              "format" : "sql",
              "expression" : "floor(3*rand())"
            }
          }
        } ],
        "activeTab" : "transformations",
        "columnsSelector" : [ ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.0.4&projectSubscriptionProjectId=12654&path=gems/SchemaTransform",
        "projectId" : "12654",
        "projectName" : "ProphecySparkBasicsPython",
        "version" : "0.0.4"
      }
    },
    "ijP-AI7o0asM_ss70X5IP" : {
      "id" : "ijP-AI7o0asM_ss70X5IP",
      "component" : "Deduplicate",
      "metadata" : {
        "label" : "Deduplicate_1",
        "slug" : "Deduplicate_1",
        "x" : 560.0005275352471,
        "y" : 160,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false,
        "comment" : "Remove any duplicate customer_id. "
      },
      "ports" : {
        "inputs" : [ {
          "id" : "QeD23uC8wixYTZ_to5c89",
          "slug" : "in0"
        } ],
        "outputs" : [ {
          "id" : "5aAZFmF8E-INCsFuFfWAN",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "dedupColumns" : [ {
          "colName" : "customer_id"
        } ],
        "dedupType" : "any",
        "columnsSelector" : [ "QeD23uC8wixYTZ_to5c89$$diWVcVbwuqoaHEe6Ojiac##customer_id" ],
        "orders" : [ ],
        "useOrderBy" : false
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.0.4&projectSubscriptionProjectId=12654&path=gems/Deduplicate",
        "projectId" : "12654",
        "projectName" : "ProphecySparkBasicsPython",
        "version" : "0.0.4"
      }
    },
    "BO3hrv5tZ8LxoTOjZ6Ajv" : {
      "id" : "BO3hrv5tZ8LxoTOjZ6Ajv",
      "component" : "SchemaTransform",
      "metadata" : {
        "label" : "SchemaTransform_3",
        "slug" : "SchemaTransform_3",
        "x" : 1160,
        "y" : 460,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false,
        "comment" : "For this distribution of rows, we will make modifications to existing customer_ids, simulating updates."
      },
      "ports" : {
        "inputs" : [ {
          "id" : "gJ4OqobFeoe-4rQkQYgsz",
          "slug" : "in0"
        } ],
        "outputs" : [ {
          "id" : "Id2XhH-cygg4tUCsh-uJI",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "importLanguage" : "sql",
        "importString" : "",
        "transformations" : [ {
          "MissingColumn" : {
            "sourceColumn" : "",
            "defaultValue" : {
              "expression" : "",
              "format" : "python"
            }
          },
          "DropColumn" : {
            "sourceColumn" : ""
          },
          "kind" : "AddReplaceColumn",
          "RenameColumn" : {
            "sourceColumn" : "",
            "targetColumn" : ""
          },
          "AddReplaceColumn" : {
            "sourceColumn" : "customer_name",
            "expression" : {
              "format" : "sql",
              "expression" : "if(rand() > 0.5, upper(customer_name), lower(customer_name))"
            }
          }
        } ],
        "activeTab" : "transformations",
        "columnsSelector" : [ "gJ4OqobFeoe-4rQkQYgsz$$1kTwf3XaDHlc-CW1ED_YR##customer_name" ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.0.4&projectSubscriptionProjectId=12654&path=gems/SchemaTransform",
        "projectId" : "12654",
        "projectName" : "ProphecySparkBasicsPython",
        "version" : "0.0.4"
      }
    },
    "ULnjpJmU0yQOfWY7sIxk5" : {
      "id" : "ULnjpJmU0yQOfWY7sIxk5",
      "component" : "SchemaTransform",
      "metadata" : {
        "label" : "DropRandomId",
        "slug" : "DropRandomId",
        "x" : 1560.0007206304692,
        "y" : 160,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false,
        "comment" : "Drop the random_id column that was generated in the earlier SchemaTransform gem. "
      },
      "ports" : {
        "inputs" : [ {
          "id" : "obfkU4wZhOigLfWcLbrvN",
          "slug" : "in0"
        } ],
        "outputs" : [ {
          "id" : "pLt1sEek6bBZM0u-uqkYC",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "importLanguage" : "sql",
        "importString" : "",
        "transformations" : [ {
          "MissingColumn" : {
            "sourceColumn" : "",
            "defaultValue" : {
              "expression" : "",
              "format" : "python"
            }
          },
          "DropColumn" : {
            "sourceColumn" : "random_id"
          },
          "kind" : "DropColumn",
          "RenameColumn" : {
            "sourceColumn" : "",
            "targetColumn" : ""
          },
          "AddReplaceColumn" : {
            "sourceColumn" : "",
            "expression" : {
              "expression" : "",
              "format" : "python"
            }
          }
        } ],
        "activeTab" : "transformations",
        "columnsSelector" : [ "obfkU4wZhOigLfWcLbrvN$$FvPwanEvAs7zHWrfTtf3W##random_id" ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.0.4&projectSubscriptionProjectId=12654&path=gems/SchemaTransform",
        "projectId" : "12654",
        "projectName" : "ProphecySparkBasicsPython",
        "version" : "0.0.4"
      }
    },
    "pMN06Mx4cGNCTF5xIo19z" : {
      "id" : "pMN06Mx4cGNCTF5xIo19z",
      "component" : "Source",
      "metadata" : {
        "label" : "customers_raw",
        "slug" : "customers_raw",
        "x" : 160.00096079878793,
        "y" : 160,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false,
        "comment" : "Reads Customers CSV file from retail dataset."
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "nRKFrJk3FjH1GHN-QgsN9",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "format" : "csv",
        "datasetTypes" : [ {
          "label" : "FILE",
          "value" : "File",
          "icon" : "File",
          "width" : "220px"
        }, {
          "label" : "WAREHOUSE",
          "value" : "Warehouse",
          "icon" : "Database",
          "width" : "220px"
        }, {
          "label" : "CATALOG TABLE",
          "value" : "Database",
          "icon" : "Table",
          "width" : "220px"
        } ],
        "dataFormats" : [ {
          "label" : "PARQUET",
          "value" : "parquet",
          "icon" : "Parquet",
          "width" : "220px"
        }, {
          "label" : "AVRO",
          "value" : "avro",
          "icon" : "File",
          "width" : "220px"
        }, {
          "label" : "TEXT",
          "value" : "text",
          "icon" : "Document",
          "width" : "220px"
        }, {
          "label" : "DELTA",
          "value" : "delta",
          "icon" : "Delta",
          "width" : "220px"
        }, {
          "label" : "JSON",
          "value" : "json",
          "icon" : "Json",
          "width" : "220px"
        }, {
          "label" : "ORC",
          "value" : "orc",
          "icon" : "File",
          "width" : "220px"
        }, {
          "label" : "KAFKASTREAM",
          "value" : "KafkaStream",
          "icon" : "File",
          "width" : "220px"
        }, {
          "label" : "CSV",
          "value" : "csv",
          "icon" : "Csv",
          "width" : "220px"
        }, {
          "label" : "XML",
          "value" : "xml",
          "icon" : "File",
          "width" : "220px"
        }, {
          "label" : "XLSX",
          "value" : "xlsx",
          "icon" : "File",
          "width" : "220px"
        } ],
        "datasetId" : "datasets/customers_raw",
        "updated" : true,
        "currentDatasetId" : "datasets/customers_raw",
        "componentInfo" : {
          "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.0.4&projectSubscriptionProjectId=12654&path=gems/csv",
          "projectId" : "12654",
          "projectName" : "ProphecySparkBasicsPython",
          "version" : "0.0.4"
        },
        "dataset" : {
          "ignoreLeadingWhiteSpaceReading" : null,
          "multiLine" : null,
          "path" : "dbfs:/databricks-datasets/retail-org/customers/customers.csv",
          "ignoreTrailingWhiteSpaceReading" : null,
          "maxColumns" : null,
          "writeMode" : "error",
          "separator" : ",",
          "compression" : null,
          "nullValue" : null,
          "nanValue" : null,
          "escapeQuotes" : null,
          "charToEscapeQuoteEscaping" : null,
          "encoding" : null,
          "inferSchema" : true,
          "enforceSchema" : null,
          "quoteAll" : null,
          "ignoreLeadingWhiteSpaceWriting" : null,
          "locale" : null,
          "quote" : null,
          "timestampFormat" : null,
          "emptyValue" : null,
          "recursiveFileLookup" : null,
          "partitionColumns" : null,
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "customer_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : { }
            }, {
              "name" : "tax_id",
              "type" : "double",
              "nullable" : true,
              "metadata" : { }
            }, {
              "name" : "tax_code",
              "type" : "string",
              "nullable" : true,
              "metadata" : { }
            }, {
              "name" : "customer_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : { }
            }, {
              "name" : "state",
              "type" : "string",
              "nullable" : true,
              "metadata" : { }
            }, {
              "name" : "city",
              "type" : "string",
              "nullable" : true,
              "metadata" : { }
            }, {
              "name" : "postcode",
              "type" : "string",
              "nullable" : true,
              "metadata" : { }
            }, {
              "name" : "street",
              "type" : "string",
              "nullable" : true,
              "metadata" : { }
            }, {
              "name" : "number",
              "type" : "string",
              "nullable" : true,
              "metadata" : { }
            }, {
              "name" : "unit",
              "type" : "string",
              "nullable" : true,
              "metadata" : { }
            }, {
              "name" : "region",
              "type" : "string",
              "nullable" : true,
              "metadata" : { }
            }, {
              "name" : "district",
              "type" : "string",
              "nullable" : true,
              "metadata" : { }
            }, {
              "name" : "lon",
              "type" : "double",
              "nullable" : true,
              "metadata" : { }
            }, {
              "name" : "lat",
              "type" : "double",
              "nullable" : true,
              "metadata" : { }
            }, {
              "name" : "ship_to_address",
              "type" : "string",
              "nullable" : true,
              "metadata" : { }
            }, {
              "name" : "valid_from",
              "type" : "integer",
              "nullable" : true,
              "metadata" : { }
            }, {
              "name" : "valid_to",
              "type" : "double",
              "nullable" : true,
              "metadata" : { }
            }, {
              "name" : "units_purchased",
              "type" : "double",
              "nullable" : true,
              "metadata" : { }
            }, {
              "name" : "loyalty_segment",
              "type" : "integer",
              "nullable" : true,
              "metadata" : { }
            } ]
          },
          "escape" : null,
          "unescapedQuoteHandling" : null,
          "positiveInf" : null,
          "comment" : null,
          "lineSep" : null,
          "samplingRatio" : null,
          "dateFormat" : null,
          "mode" : null,
          "header" : true,
          "columnNameOfCorruptRecord" : null,
          "modifiedBefore" : null,
          "ignoreTrailingWhiteSpaceWriting" : null,
          "maxCharsPerColumn" : null,
          "negativeInf" : null,
          "pathGlobFilter" : null,
          "useSchema" : true,
          "modifiedAfter" : null
        },
        "isNewDataset" : false,
        "disabled" : false,
        "datasetType" : "File"
      }
    },
    "Dj6oja_WmBTXMN3AJOvSx" : {
      "id" : "Dj6oja_WmBTXMN3AJOvSx",
      "component" : "SchemaTransform",
      "metadata" : {
        "label" : "SchemaTransform_2",
        "slug" : "SchemaTransform_2",
        "x" : 1160,
        "y" : 260,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false,
        "comment" : "For this distribution of rows, we will change the customer_id to a totally new id, simulating new incoming rows. "
      },
      "ports" : {
        "inputs" : [ {
          "id" : "CqUNgShTLlIP_9rGWdQw5",
          "slug" : "in0"
        } ],
        "outputs" : [ {
          "id" : "wTsreSYOqpBYFlyOlD0Co",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "importLanguage" : "sql",
        "importString" : "",
        "transformations" : [ {
          "MissingColumn" : {
            "sourceColumn" : "",
            "defaultValue" : {
              "expression" : "",
              "format" : "python"
            }
          },
          "DropColumn" : {
            "sourceColumn" : ""
          },
          "kind" : "AddReplaceColumn",
          "RenameColumn" : {
            "sourceColumn" : "",
            "targetColumn" : ""
          },
          "AddReplaceColumn" : {
            "sourceColumn" : "customer_id",
            "expression" : {
              "format" : "sql",
              "expression" : "customer_id + cast(floor(rand() * 10000) as int)"
            }
          }
        } ],
        "activeTab" : "transformations",
        "columnsSelector" : [ "CqUNgShTLlIP_9rGWdQw5$$wHHgNENFY-EqMijXshxKd##customer_id" ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.0.4&projectSubscriptionProjectId=12654&path=gems/SchemaTransform",
        "projectId" : "12654",
        "projectName" : "ProphecySparkBasicsPython",
        "version" : "0.0.4"
      }
    },
    "YsLv9M_vzkBBbsxYJUCUV" : {
      "id" : "YsLv9M_vzkBBbsxYJUCUV",
      "component" : "RowDistributor",
      "metadata" : {
        "label" : "RowDistributor_1",
        "slug" : "RowDistributor_1",
        "x" : 960.0005268311457,
        "y" : 160,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false,
        "comment" : "The function splits the existing dataframe into three separate dataframes depending on the randomly assigned random_id number."
      },
      "ports" : {
        "inputs" : [ {
          "id" : "DltODBRTEWjBdDbNIpVxy",
          "slug" : "in0"
        } ],
        "outputs" : [ {
          "id" : "1Uz_9EH85JsTgAYbj-mkd",
          "slug" : "out0"
        }, {
          "id" : "BzetactkhDOfMOg2gSh6w",
          "slug" : "out1"
        }, {
          "id" : "3tTwgv9x04B4cnmRTuIvR",
          "slug" : "out2"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "outports" : [ {
          "path" : "out0",
          "id" : "1Uz_9EH85JsTgAYbj-mkd$$_UWeRxDU5NA9MbroW6QWn",
          "model" : {
            "format" : "sql",
            "expression" : "random_id = 0"
          }
        }, {
          "path" : "out1",
          "id" : "BzetactkhDOfMOg2gSh6w$$K9F4-aOVjWRRZ12Wnsvul",
          "model" : {
            "format" : "sql",
            "expression" : "random_id = 1"
          }
        }, {
          "path" : "out2",
          "id" : "3tTwgv9x04B4cnmRTuIvR$$vNhwHvIU0yNpekGKONEGb",
          "model" : {
            "format" : "sql",
            "expression" : "random_id = 2"
          }
        } ],
        "distributeUnmatchedRows" : null
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.0.4&projectSubscriptionProjectId=12654&path=gems/RowDistributor",
        "projectId" : "12654",
        "projectName" : "ProphecySparkBasicsPython",
        "version" : "0.0.4"
      }
    },
    "_wPo8nbcxQjMT-oUP80vb" : {
      "id" : "_wPo8nbcxQjMT-oUP80vb",
      "component" : "SetOperation",
      "metadata" : {
        "label" : "SetOperation_1",
        "slug" : "SetOperation_1",
        "x" : 1360.0005856762066,
        "y" : 160,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false,
        "comment" : "The function does a union of the three distributions of data across three dataframes. The 1st subset simulates unchanged data. The 2nd subset simulates updated existing records. The 3rd subset simulates brand new records. "
      },
      "ports" : {
        "inputs" : [ {
          "id" : "QfE6jzKSeJ2e8ieA7Cp7D",
          "slug" : "in0"
        }, {
          "id" : "t2NliMEf8MbMxm93AW1-f",
          "slug" : "in1"
        }, {
          "id" : "Ns16gtqhh32YXej-8Kn3q",
          "slug" : "in2"
        } ],
        "outputs" : [ {
          "id" : "DolCO-f59RV5mwmX4Vapr",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "operationType" : "unionAll",
        "allowMissingColumns" : false
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.0.4&projectSubscriptionProjectId=12654&path=gems/SetOperation",
        "projectId" : "12654",
        "projectName" : "ProphecySparkBasicsPython",
        "version" : "0.0.4"
      }
    },
    "oYnx2RIhGhCqQyq7sNfpI" : {
      "id" : "oYnx2RIhGhCqQyq7sNfpI",
      "component" : "Reformat",
      "metadata" : {
        "label" : "SelectFields",
        "slug" : "SelectFields",
        "x" : 360.0000867557395,
        "y" : 160,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false,
        "comment" : "This gem selects a subset of relevant columns from the original CSV file. "
      },
      "ports" : {
        "inputs" : [ {
          "id" : "mM7ir_D0scKCAg_eQl4Ru",
          "slug" : "in0"
        } ],
        "outputs" : [ {
          "id" : "WjscrqYe7iGTGw6ehkQg6",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "importLanguage" : "${$.workflow.metainfo.frontEndLanguage}",
        "expressions" : [ {
          "target" : "customer_id",
          "expression" : {
            "format" : "sql",
            "expression" : "customer_id"
          },
          "description" : "",
          "_row_id" : "699837511990524634"
        }, {
          "target" : "tax_id",
          "expression" : {
            "format" : "sql",
            "expression" : "tax_id"
          },
          "description" : "",
          "_row_id" : "2383481751085905201"
        }, {
          "target" : "tax_code",
          "expression" : {
            "format" : "sql",
            "expression" : "tax_code"
          },
          "description" : "",
          "_row_id" : "4388283887922264671"
        }, {
          "target" : "customer_name",
          "expression" : {
            "format" : "sql",
            "expression" : "customer_name"
          },
          "description" : "",
          "_row_id" : "1230301946556493643"
        }, {
          "target" : "state",
          "expression" : {
            "format" : "sql",
            "expression" : "state"
          },
          "description" : "",
          "_row_id" : "8282603464814339602"
        } ],
        "importString" : "",
        "activeTab" : "expressions",
        "columnsSelector" : [ "mM7ir_D0scKCAg_eQl4Ru$$DJ1UeHrUnGYtXUuCGmbPF##state", "mM7ir_D0scKCAg_eQl4Ru$$DJ1UeHrUnGYtXUuCGmbPF##customer_name", "mM7ir_D0scKCAg_eQl4Ru$$DJ1UeHrUnGYtXUuCGmbPF##tax_id", "mM7ir_D0scKCAg_eQl4Ru$$DJ1UeHrUnGYtXUuCGmbPF##tax_code", "mM7ir_D0scKCAg_eQl4Ru$$DJ1UeHrUnGYtXUuCGmbPF##customer_id" ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.0.4&projectSubscriptionProjectId=12654&path=gems/Reformat",
        "projectId" : "12654",
        "projectName" : "ProphecySparkBasicsPython",
        "version" : "0.0.4"
      }
    }
  },
  "externalDependencies" : [ ]
}